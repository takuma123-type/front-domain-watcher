{"ast":null,"code":"import _regeneratorRuntime from\"/usr/src/app/admin_front/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"/usr/src/app/admin_front/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _toConsumableArray from\"/usr/src/app/admin_front/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"/usr/src/app/admin_front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/usr/src/app/admin_front/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,useRef}from\"react\";import{Helmet,HelmetProvider}from\"react-helmet-async\";import{ChatRepository}from\"../../infrastructure/repositories/ChatRepository\";import{Header}from\"../molecules/Header\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var meta={title:\"\",meta:[],link:[],style:[],script:[]};export default function Index(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),prompt=_useState2[0],setPrompt=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),chatHistory=_useState4[0],setChatHistory=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),error=_useState8[0],setError=_useState8[1];var chatEndRef=useRef(null);var handleSend=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var newMessage,chatRepo,data,updatedMessage;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!(loading||prompt.trim()===\"\")){_context.next=2;break;}return _context.abrupt(\"return\");case 2:newMessage={prompt:prompt,response:\"\"};setChatHistory([].concat(_toConsumableArray(chatHistory),[newMessage]));setPrompt(\"\");setLoading(true);setError(null);chatRepo=new ChatRepository();_context.prev=8;_context.next=11;return chatRepo.post(prompt);case 11:data=_context.sent;updatedMessage=_objectSpread(_objectSpread({},newMessage),{},{response:data.response});setChatHistory(function(prev){return prev.map(function(msg,index){return index===prev.length-1?updatedMessage:msg;});});_context.next=20;break;case 16:_context.prev=16;_context.t0=_context[\"catch\"](8);console.error(\"Error:\",_context.t0);setError(\"メッセージの送信中にエラーが発生しました。もう一度お試しください。\");case 20:_context.prev=20;setLoading(false);return _context.finish(20);case 23:case\"end\":return _context.stop();}},_callee,null,[[8,16,20,23]]);}));return function handleSend(){return _ref.apply(this,arguments);};}();useEffect(function(){var _chatEndRef$current;(_chatEndRef$current=chatEndRef.current)===null||_chatEndRef$current===void 0?void 0:_chatEndRef$current.scrollIntoView({behavior:\"smooth\"});},[chatHistory,loading]);return/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(HelmetProvider,{children:/*#__PURE__*/_jsx(Helmet,_objectSpread({},meta))}),/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col h-screen bg-gray-100 pt-16\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col flex-grow p-4 overflow-auto\",children:[chatHistory.map(function(chat,index){return/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end items-end\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-green-400 text-white p-3 rounded-xl shadow-md max-w-xs\",children:chat.prompt}),/*#__PURE__*/_jsx(\"img\",{src:\"/images/shomajirou.png\",alt:\"User\",className:\"w-10 h-10 rounded-full ml-2\"})]}),chat.response&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-start items-start mt-2\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/images/\\u30A2\\u30A6\\u30E9dot.png\",alt:\"Partner\",className:\"w-10 h-10 rounded-full mr-2\"}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-300 text-black p-3 rounded-xl shadow-md max-w-xs\",children:chat.response})]})]},index);}),loading&&/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"loader border-t-4 border-green-400 rounded-full w-8 h-8 animate-spin\"})}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500 text-center mt-4\",children:error}),/*#__PURE__*/_jsx(\"div\",{ref:chatEndRef})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-white flex items-center border-t border-gray-200\",children:[/*#__PURE__*/_jsx(\"textarea\",{className:\"flex-grow p-2 border rounded-lg mr-2\",value:prompt,onChange:function onChange(e){return setPrompt(e.target.value);},placeholder:\"\\u30E1\\u30C3\\u30BB\\u30FC\\u30B8\\u3092\\u5165\\u529B\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\"}),/*#__PURE__*/_jsx(\"button\",{className:\"bg-green-400 text-white p-2 rounded-lg \".concat(loading?\"opacity-50 cursor-not-allowed\":\"\"),onClick:handleSend,disabled:loading,children:\"\\u9001\\u4FE1\"})]})]})]});}","map":{"version":3,"names":["React","useState","useEffect","useRef","Helmet","HelmetProvider","ChatRepository","Header","jsx","_jsx","jsxs","_jsxs","meta","title","link","style","script","Index","_useState","_useState2","_slicedToArray","prompt","setPrompt","_useState3","_useState4","chatHistory","setChatHistory","_useState5","_useState6","loading","setLoading","_useState7","_useState8","error","setError","chatEndRef","handleSend","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","newMessage","chatRepo","data","updatedMessage","wrap","_callee$","_context","prev","next","trim","abrupt","response","concat","_toConsumableArray","post","sent","_objectSpread","map","msg","index","length","t0","console","finish","stop","apply","arguments","_chatEndRef$current","current","scrollIntoView","behavior","Fragment","children","className","chat","src","alt","ref","value","onChange","e","target","placeholder","onClick","disabled"],"sources":["/usr/src/app/admin_front/src/components/pages/Index.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport { Helmet, HelmetProvider } from \"react-helmet-async\";\nimport { ChatRepository } from \"../../infrastructure/repositories/ChatRepository\";\nimport { Header } from \"../molecules/Header\";\n\nconst meta = {\n  title: \"\",\n  meta: [],\n  link: [],\n  style: [],\n  script: [],\n};\n\ninterface ChatMessage {\n  prompt: string;\n  response: string;\n}\n\nexport default function Index() {\n  const [prompt, setPrompt] = useState(\"\");\n  const [chatHistory, setChatHistory] = useState<ChatMessage[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const chatEndRef = useRef<HTMLDivElement>(null);\n\n  const handleSend = async () => {\n    if (loading || prompt.trim() === \"\") return;\n\n    const newMessage: ChatMessage = { prompt, response: \"\" };\n    setChatHistory([...chatHistory, newMessage]);\n    setPrompt(\"\");\n    setLoading(true);\n    setError(null);\n\n    const chatRepo = new ChatRepository();\n    try {\n      const data = await chatRepo.post(prompt);\n      const updatedMessage: ChatMessage = { ...newMessage, response: data.response };\n      setChatHistory((prev) => prev.map((msg, index) => index === prev.length - 1 ? updatedMessage : msg));\n    } catch (error) {\n      console.error(\"Error:\", error);\n      setError(\"メッセージの送信中にエラーが発生しました。もう一度お試しください。\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    chatEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  }, [chatHistory, loading]);\n\n  return (\n    <React.Fragment>\n      <HelmetProvider>\n        <Helmet {...meta}></Helmet>\n      </HelmetProvider>\n      <Header />\n      <div className=\"flex flex-col h-screen bg-gray-100 pt-16\">\n        <div className=\"flex flex-col flex-grow p-4 overflow-auto\">\n          {chatHistory.map((chat, index) => (\n            <div key={index} className=\"mb-4\">\n              <div className=\"flex justify-end items-end\">\n                <div className=\"bg-green-400 text-white p-3 rounded-xl shadow-md max-w-xs\">\n                  {chat.prompt}\n                </div>\n                <img\n                  src=\"/images/shomajirou.png\"\n                  alt=\"User\"\n                  className=\"w-10 h-10 rounded-full ml-2\"\n                />\n              </div>\n              {chat.response && (\n                <div className=\"flex justify-start items-start mt-2\">\n                  <img\n                    src=\"/images/アウラdot.png\"\n                    alt=\"Partner\"\n                    className=\"w-10 h-10 rounded-full mr-2\"\n                  />\n                  <div className=\"bg-gray-300 text-black p-3 rounded-xl shadow-md max-w-xs\">\n                    {chat.response}\n                  </div>\n                </div>\n              )}\n            </div>\n          ))}\n          {loading && (\n            <div className=\"flex justify-center items-center\">\n              <div className=\"loader border-t-4 border-green-400 rounded-full w-8 h-8 animate-spin\"></div>\n            </div>\n          )}\n          {error && (\n            <div className=\"text-red-500 text-center mt-4\">\n              {error}\n            </div>\n          )}\n          <div ref={chatEndRef}></div>\n        </div>\n        <div className=\"p-4 bg-white flex items-center border-t border-gray-200\">\n          <textarea\n            className=\"flex-grow p-2 border rounded-lg mr-2\"\n            value={prompt}\n            onChange={(e) => setPrompt(e.target.value)}\n            placeholder=\"メッセージを入力してください\"\n          />\n          <button\n            className={`bg-green-400 text-white p-2 rounded-lg ${loading ? \"opacity-50 cursor-not-allowed\" : \"\"}`}\n            onClick={handleSend}\n            disabled={loading}\n          >\n            送信\n          </button>\n        </div>\n      </div>\n    </React.Fragment>\n  );\n}\n"],"mappings":"6jBAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,CAAEC,MAAM,KAAQ,OAAO,CAC1D,OAASC,MAAM,CAAEC,cAAc,KAAQ,oBAAoB,CAC3D,OAASC,cAAc,KAAQ,kDAAkD,CACjF,OAASC,MAAM,KAAQ,qBAAqB,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAE7C,GAAM,CAAAC,IAAI,CAAG,CACXC,KAAK,CAAE,EAAE,CACTD,IAAI,CAAE,EAAE,CACRE,IAAI,CAAE,EAAE,CACRC,KAAK,CAAE,EAAE,CACTC,MAAM,CAAE,EACV,CAAC,CAOD,cAAe,SAAS,CAAAC,KAAKA,CAAA,CAAG,CAC9B,IAAAC,SAAA,CAA4BjB,QAAQ,CAAC,EAAE,CAAC,CAAAkB,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAAjCG,MAAM,CAAAF,UAAA,IAAEG,SAAS,CAAAH,UAAA,IACxB,IAAAI,UAAA,CAAsCtB,QAAQ,CAAgB,EAAE,CAAC,CAAAuB,UAAA,CAAAJ,cAAA,CAAAG,UAAA,IAA1DE,WAAW,CAAAD,UAAA,IAAEE,cAAc,CAAAF,UAAA,IAClC,IAAAG,UAAA,CAA8B1B,QAAQ,CAAC,KAAK,CAAC,CAAA2B,UAAA,CAAAR,cAAA,CAAAO,UAAA,IAAtCE,OAAO,CAAAD,UAAA,IAAEE,UAAU,CAAAF,UAAA,IAC1B,IAAAG,UAAA,CAA0B9B,QAAQ,CAAgB,IAAI,CAAC,CAAA+B,UAAA,CAAAZ,cAAA,CAAAW,UAAA,IAAhDE,KAAK,CAAAD,UAAA,IAAEE,QAAQ,CAAAF,UAAA,IACtB,GAAM,CAAAG,UAAU,CAAGhC,MAAM,CAAiB,IAAI,CAAC,CAE/C,GAAM,CAAAiC,UAAU,6BAAAC,IAAA,CAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,QAAA,MAAAC,UAAA,CAAAC,QAAA,CAAAC,IAAA,CAAAC,cAAA,QAAAN,mBAAA,GAAAO,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,cACbrB,OAAO,EAAIR,MAAM,CAAC8B,IAAI,CAAC,CAAC,GAAK,EAAE,GAAAH,QAAA,CAAAE,IAAA,iBAAAF,QAAA,CAAAI,MAAA,kBAE7BV,UAAuB,CAAG,CAAErB,MAAM,CAANA,MAAM,CAAEgC,QAAQ,CAAE,EAAG,CAAC,CACxD3B,cAAc,IAAA4B,MAAA,CAAAC,kBAAA,CAAK9B,WAAW,GAAEiB,UAAU,EAAC,CAAC,CAC5CpB,SAAS,CAAC,EAAE,CAAC,CACbQ,UAAU,CAAC,IAAI,CAAC,CAChBI,QAAQ,CAAC,IAAI,CAAC,CAERS,QAAQ,CAAG,GAAI,CAAArC,cAAc,CAAC,CAAC,CAAA0C,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA,UAEhB,CAAAP,QAAQ,CAACa,IAAI,CAACnC,MAAM,CAAC,SAAlCuB,IAAI,CAAAI,QAAA,CAAAS,IAAA,CACJZ,cAA2B,CAAAa,aAAA,CAAAA,aAAA,IAAQhB,UAAU,MAAEW,QAAQ,CAAET,IAAI,CAACS,QAAQ,GAC5E3B,cAAc,CAAC,SAACuB,IAAI,QAAK,CAAAA,IAAI,CAACU,GAAG,CAAC,SAACC,GAAG,CAAEC,KAAK,QAAK,CAAAA,KAAK,GAAKZ,IAAI,CAACa,MAAM,CAAG,CAAC,CAAGjB,cAAc,CAAGe,GAAG,GAAC,GAAC,CAACZ,QAAA,CAAAE,IAAA,kBAAAF,QAAA,CAAAC,IAAA,IAAAD,QAAA,CAAAe,EAAA,CAAAf,QAAA,aAErGgB,OAAO,CAAC/B,KAAK,CAAC,QAAQ,CAAAe,QAAA,CAAAe,EAAO,CAAC,CAC9B7B,QAAQ,CAAC,mCAAmC,CAAC,CAAC,QAAAc,QAAA,CAAAC,IAAA,IAE9CnB,UAAU,CAAC,KAAK,CAAC,CAAC,OAAAkB,QAAA,CAAAiB,MAAA,8BAAAjB,QAAA,CAAAkB,IAAA,MAAAzB,OAAA,uBAErB,kBApBK,CAAAL,UAAUA,CAAA,SAAAC,IAAA,CAAA8B,KAAA,MAAAC,SAAA,OAoBf,CAEDlE,SAAS,CAAC,UAAM,KAAAmE,mBAAA,CACd,CAAAA,mBAAA,CAAAlC,UAAU,CAACmC,OAAO,UAAAD,mBAAA,iBAAlBA,mBAAA,CAAoBE,cAAc,CAAC,CAAEC,QAAQ,CAAE,QAAS,CAAC,CAAC,CAC5D,CAAC,CAAE,CAAC/C,WAAW,CAAEI,OAAO,CAAC,CAAC,CAE1B,mBACElB,KAAA,CAACX,KAAK,CAACyE,QAAQ,EAAAC,QAAA,eACbjE,IAAA,CAACJ,cAAc,EAAAqE,QAAA,cACbjE,IAAA,CAACL,MAAM,CAAAsD,aAAA,IAAK9C,IAAI,CAAU,CAAC,CACb,CAAC,cACjBH,IAAA,CAACF,MAAM,GAAE,CAAC,cACVI,KAAA,QAAKgE,SAAS,CAAC,0CAA0C,CAAAD,QAAA,eACvD/D,KAAA,QAAKgE,SAAS,CAAC,2CAA2C,CAAAD,QAAA,EACvDjD,WAAW,CAACkC,GAAG,CAAC,SAACiB,IAAI,CAAEf,KAAK,qBAC3BlD,KAAA,QAAiBgE,SAAS,CAAC,MAAM,CAAAD,QAAA,eAC/B/D,KAAA,QAAKgE,SAAS,CAAC,4BAA4B,CAAAD,QAAA,eACzCjE,IAAA,QAAKkE,SAAS,CAAC,2DAA2D,CAAAD,QAAA,CACvEE,IAAI,CAACvD,MAAM,CACT,CAAC,cACNZ,IAAA,QACEoE,GAAG,CAAC,wBAAwB,CAC5BC,GAAG,CAAC,MAAM,CACVH,SAAS,CAAC,6BAA6B,CACxC,CAAC,EACC,CAAC,CACLC,IAAI,CAACvB,QAAQ,eACZ1C,KAAA,QAAKgE,SAAS,CAAC,qCAAqC,CAAAD,QAAA,eAClDjE,IAAA,QACEoE,GAAG,CAAC,mCAAoB,CACxBC,GAAG,CAAC,SAAS,CACbH,SAAS,CAAC,6BAA6B,CACxC,CAAC,cACFlE,IAAA,QAAKkE,SAAS,CAAC,0DAA0D,CAAAD,QAAA,CACtEE,IAAI,CAACvB,QAAQ,CACX,CAAC,EACH,CACN,GAtBOQ,KAuBL,CAAC,EACP,CAAC,CACDhC,OAAO,eACNpB,IAAA,QAAKkE,SAAS,CAAC,kCAAkC,CAAAD,QAAA,cAC/CjE,IAAA,QAAKkE,SAAS,CAAC,sEAAsE,CAAM,CAAC,CACzF,CACN,CACA1C,KAAK,eACJxB,IAAA,QAAKkE,SAAS,CAAC,+BAA+B,CAAAD,QAAA,CAC3CzC,KAAK,CACH,CACN,cACDxB,IAAA,QAAKsE,GAAG,CAAE5C,UAAW,CAAM,CAAC,EACzB,CAAC,cACNxB,KAAA,QAAKgE,SAAS,CAAC,yDAAyD,CAAAD,QAAA,eACtEjE,IAAA,aACEkE,SAAS,CAAC,sCAAsC,CAChDK,KAAK,CAAE3D,MAAO,CACd4D,QAAQ,CAAE,SAAAA,SAACC,CAAC,QAAK,CAAA5D,SAAS,CAAC4D,CAAC,CAACC,MAAM,CAACH,KAAK,CAAC,EAAC,CAC3CI,WAAW,CAAC,sFAAgB,CAC7B,CAAC,cACF3E,IAAA,WACEkE,SAAS,2CAAArB,MAAA,CAA4CzB,OAAO,CAAG,+BAA+B,CAAG,EAAE,CAAG,CACtGwD,OAAO,CAAEjD,UAAW,CACpBkD,QAAQ,CAAEzD,OAAQ,CAAA6C,QAAA,CACnB,cAED,CAAQ,CAAC,EACN,CAAC,EACH,CAAC,EACQ,CAAC,CAErB"},"metadata":{},"sourceType":"module","externalDependencies":[]}